<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HydraBench: Claim Radar</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --bg: #fff;
            --bg-alt: #F7F6F3;
            --text: #37352F;
            --text-dim: #787774;
            --border: #E0E0E0;
        }
        [data-theme="dark"] {
            --bg: #191919;
            --bg-alt: #232323;
            --text: #E8E6E3;
            --text-dim: #9B9A97;
            --border: #333;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            padding: 24px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        h2 { font-size: 1.3rem; margin-bottom: 4px; }
        .subtitle { color: var(--text-dim); font-size: 0.85rem; }
        .theme-toggle {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--bg-alt);
            color: var(--text);
            font-size: 0.8rem;
            cursor: pointer;
        }
        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        .fw-btn {
            padding: 6px 14px;
            border: 2px solid var(--border);
            border-radius: 6px;
            background: var(--bg);
            color: var(--text);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.15s;
        }
        .fw-btn:hover { opacity: 0.8; }
        .fw-btn.active { color: #fff; }
        .chart-wrap {
            background: var(--bg-alt);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 24px;
            display: flex;
            justify-content: center;
        }
        .chart-inner {
            max-width: 520px;
            width: 100%;
        }
        .claim-details {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        .claim-card {
            background: var(--bg-alt);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 14px;
        }
        .claim-name {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-dim);
            margin-bottom: 4px;
        }
        .claim-score { font-size: 1.4rem; font-weight: 700; }
        .claim-weight { font-size: 0.75rem; color: var(--text-dim); }
        .footnote { margin-top: 16px; font-size: 0.75rem; color: var(--text-dim); }
        @media (max-width: 600px) {
            .chart-wrap { padding: 12px; }
            .claim-details { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h2>Claim Coverage Radar</h2>
                <p class="subtitle">Per-claim score comparison across frameworks. Toggle frameworks to compare.</p>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">Toggle theme</button>
        </div>

        <div class="controls" id="fw-buttons"></div>

        <div class="chart-wrap">
            <div class="chart-inner">
                <canvas id="radarChart"></canvas>
            </div>
        </div>

        <div class="claim-details" id="details"></div>

        <p class="footnote">Each axis represents one of the 5 claims tested. Score = mean across all scenarios in that claim category. Weights: Crash Recovery 25%, Secrets 25%, Handoffs 20%, Channels 15%, Cost 15%.</p>
    </div>

    <script>
        const CLAIMS = ["Crash Recovery", "Secrets", "Handoffs", "Channels", "Cost Control"];
        const CLAIM_KEYS = ["crash_recovery", "secret_containment", "handoff_reliability", "channel_security", "cost_control"];
        const CLAIM_WEIGHTS = [0.25, 0.25, 0.20, 0.15, 0.15];

        const FRAMEWORKS = [
            {
                name: "OpenHydra",
                color: "#4a9eff",
                scores: [96.58, 98.72, 95.94, 99.33, 95.91],
                stds: [2.02, 1.18, 1.49, 1.05, 1.54]
            },
            {
                name: "LangGraph",
                color: "#F2994A",
                scores: [55.8, 0, 41.76, 0, 38.09],
                stds: [2.5, 0, 3.2, 0, 2.8]
            },
            {
                name: "CrewAI",
                color: "#EB5757",
                scores: [0, 0, 0, 0, 0],
                stds: [0, 0, 0, 0, 0]
            },
            {
                name: "Bare Agent",
                color: "#9B9A97",
                scores: [0, 0, 0, 0, 0],
                stds: [0, 0, 0, 0, 0]
            }
        ];

        let activeFrameworks = new Set(["OpenHydra", "LangGraph"]);
        let chart = null;

        function buildButtons() {
            const container = document.getElementById("fw-buttons");
            container.innerHTML = "";
            FRAMEWORKS.forEach(fw => {
                const btn = document.createElement("button");
                btn.className = "fw-btn" + (activeFrameworks.has(fw.name) ? " active" : "");
                btn.textContent = fw.name;
                btn.style.borderColor = fw.color;
                if (activeFrameworks.has(fw.name)) {
                    btn.style.background = fw.color;
                }
                btn.addEventListener("click", () => {
                    if (activeFrameworks.has(fw.name)) activeFrameworks.delete(fw.name);
                    else activeFrameworks.add(fw.name);
                    buildButtons();
                    buildChart();
                    buildDetails();
                });
                container.appendChild(btn);
            });
        }

        function isDark() { return document.documentElement.dataset.theme === "dark"; }

        function buildChart() {
            const ctx = document.getElementById("radarChart").getContext("2d");
            if (chart) chart.destroy();

            const datasets = FRAMEWORKS
                .filter(fw => activeFrameworks.has(fw.name))
                .map(fw => ({
                    label: fw.name,
                    data: fw.scores,
                    borderColor: fw.color,
                    backgroundColor: fw.color + "22",
                    borderWidth: 2,
                    pointBackgroundColor: fw.color,
                    pointBorderColor: "#fff",
                    pointBorderWidth: 1,
                    pointRadius: 4,
                }));

            const gridColor = isDark() ? "#444" : "#ddd";
            const textColor = isDark() ? "#9B9A97" : "#787774";

            chart = new Chart(ctx, {
                type: "radar",
                data: { labels: CLAIMS, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: isDark() ? "#2d2d2d" : "#fff",
                            titleColor: isDark() ? "#E8E6E3" : "#37352F",
                            bodyColor: isDark() ? "#9B9A97" : "#787774",
                            borderColor: gridColor,
                            borderWidth: 1,
                            callbacks: {
                                label: ctx => `${ctx.dataset.label}: ${ctx.parsed.r.toFixed(1)}`
                            }
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                color: textColor,
                                backdropColor: "transparent",
                                font: { size: 10 }
                            },
                            grid: { color: gridColor },
                            angleLines: { color: gridColor },
                            pointLabels: {
                                color: isDark() ? "#E8E6E3" : "#37352F",
                                font: { size: 12, weight: "600" }
                            }
                        }
                    }
                }
            });
        }

        function buildDetails() {
            const container = document.getElementById("details");
            container.innerHTML = "";
            const active = FRAMEWORKS.filter(fw => activeFrameworks.has(fw.name));
            if (active.length === 0) return;

            // Show the first active framework's details
            const fw = active[0];
            CLAIMS.forEach((name, i) => {
                const card = document.createElement("div");
                card.className = "claim-card";

                let scoresHtml = active.map(f =>
                    `<span style="color:${f.color};font-weight:600">${f.scores[i].toFixed(1)}</span>`
                ).join(" / ");

                card.innerHTML = `
                    <div class="claim-name">${name}</div>
                    <div class="claim-score">${scoresHtml}</div>
                    <div class="claim-weight">Weight: ${(CLAIM_WEIGHTS[i] * 100).toFixed(0)}%</div>
                `;
                container.appendChild(card);
            });
        }

        function toggleTheme() {
            const html = document.documentElement;
            html.dataset.theme = html.dataset.theme === "dark" ? "" : "dark";
            buildChart();
        }

        buildButtons();
        buildChart();
        buildDetails();
    </script>
</body>
</html>
